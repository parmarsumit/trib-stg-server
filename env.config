files:
  "/usr/local/bin/mount-efs.sh":
    mode: "000755"
    owner: root
    group: root
    content : |
      #!/bin/bash
      sudo mkdir -p /media/share
      #sudo chmod -R 777 /media/share
      sudo echo ${EFS_URL}':/ /media/share nfs4 nfsvers=4.1,rsize=1048576,wsize=1048576,hard,timeo=600,retrans=2 0 0' >> /etc/fstab
      sudo mount -a -t nfs4
      sudo mkdir -p /media/share   # add this step to create app directory
      sudo chmod -R 777 /media/share
      echo 'EFS mount complete.'

container_commands:
  00_create_logs_directory:
    test: test ! -d /media/share
    command: mkdir -p /media/share && chown -R webapp:webapp /media/share && chmod 755 /media/share
    
  
  01_efs_mount_in_dev_devqa:
    command: "/usr/local/bin/mount-efs.sh"